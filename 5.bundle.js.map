{"version":3,"sources":["webpack:///./src/components/Slide/slide-style.ts","webpack:///./src/utils/render.tsx","webpack:///./src/components/Slide/index.tsx","webpack:///./src/components/Slide/useElements.ts","webpack:///./src/components/Slide/useSlideObserve.ts","webpack:///./src/components/Slide/useCodeLineObserve.ts","webpack:///./src/utils/parsePlugins/injectLineNumber.ts"],"names":["blockquoteStyle","css","codeStyle","headingStyle","linkStyle","listStyle","paragraphStyle","tableStyle","props","theme","colorScheme","lightgrey","slideStyle","render","htmlString","TABLE_TAGS","processingInstructions","shouldProcessNode","parent","type","includes","name","isTableDescendent","processNode","HtmlToReact","ProcessNodeDefinitions","React","processDefaultNode","Parser","lowerCaseTags","lowerCaseAttributeNames","parseWithInstructions","SlideContainer","styled","div","Slide","memo","index","ref","useRef","elements","useState","setElements","useEffect","useElements","slideNumber","useSlideObserver","observe","unobserve","current","useSlideObserve","useCodeLineObserver","node","entries","querySelectorAll","forEach","element","dataLine","getAttribute","useCodeLineObserve","className","id"],"mappings":"24DACA,IAAMA,EAAkBC,YAAH,KAOfC,EAAYD,YAAH,KAUTE,EAAeF,YAAH,KASZG,EAAYH,YAAH,KAITI,EAAYJ,YAAH,KAYTK,EAAiBL,YAAH,KAIdM,EAAaN,YAAH,KAMU,SAACO,GAAD,OAAWA,EAAMC,MAAMC,YAAYC,aAYrC,SAACH,GAAD,OAAWA,EAAMC,MAAMC,YAAYC,aAGrDC,EAAaX,YAAH,IAoBVD,EACAE,EACAC,EACAC,EACAC,EACAC,EACAC,G,kCCtFN,SAASM,EAAOC,GACd,IAAMC,EAAa,CAAC,QAAS,QAAS,QAAS,MAI/C,IAGMC,EAAyB,CAC7B,CACEC,kBADF,YACsC,IAAhBC,EAAgB,EAAhBA,OAClB,MAAa,SADqB,EAARC,OARhC,SAA2BD,GACzB,OAAOA,GAAUH,EAAWK,SAASF,EAAOG,MAQjBC,CAAkBJ,IAK3CK,YAT2B,IAAIC,IAAYC,uBAAuBC,KAS9BC,qBAOxC,OAJe,IAAIC,SAAO,CACxBC,eAAe,EACfC,yBAAyB,IAEbC,sBACZjB,GAnBkB,kBAAM,IAqBxBE,G,kLC1BJ,IAAMgB,EAAiBC,IAAOC,IAAV,KAEE,SAAC1B,GAAD,OAAWA,EAAMC,MAAMC,YAAYC,aACzB,SAACH,GAAD,OAAWA,EAAMC,MAAMC,YAAYC,YAE/DC,GAQEuB,EAAQC,gBAAK,YAAkD,IAAjCtB,EAAiC,EAAjCA,WAAYuB,EAAqB,EAArBA,MACxCC,EAAMC,iBAAuB,MAE7BC,ECtBR,SAAqB1B,GAAY,MACG2B,mBAAS,MADZ,WACtBD,EADsB,KACZE,EADY,KAG7B,OADAC,qBAAU,kBAAMD,EAAY7B,EAAOC,MAAc,CAACA,IAC3C0B,EDmBQI,CAAY9B,GAI7B,OE1BF,YAA+C,IAApBwB,EAAoB,EAApBA,IAAKO,EAAe,EAAfA,YAAe,EACZC,cAAvBC,EADmC,EACnCA,QAASC,EAD0B,EAC1BA,UACjBL,qBAAU,WAGN,OAFIL,EAAIW,SACJF,EAAQF,EAAaP,EAAIW,SACtB,kBAAMD,EAAUH,MACxB,CAACP,EAAKO,EAAaE,EAASC,IFiBjCE,CAAgB,CAAEZ,MAAKO,YAAaR,EAAQ,IGtB9C,YAA+C,IAAjBG,EAAiB,EAAjBA,SAAUF,EAAO,EAAPA,IAC5BS,EAAYI,cAAZJ,QACRJ,qBAAU,WACN,IAAMS,EAAOd,EAAIW,QACjB,GAAIG,EAAM,CACN,IAAMC,EAAU,IACSD,aAAmC,EAASA,EAAKE,iBAAL,WCGpD,eDFAC,SAAQ,SAACC,GACtB,IAAMC,EAAWD,EAAQE,aCEb,aDDRD,IACAJ,EAAQI,GAAYD,MAE5BT,EAAQM,MAEb,CAACb,EAAUF,EAAKS,IHSrBY,CAAmB,CAAEnB,WAAUF,QAG7B,kBAACN,EAAD,CAAgBM,IAAKA,EAAKsB,UAAU,QAAQC,GAAE,gBAAWxB,EAAQ,IAC9DG","file":"5.bundle.js","sourcesContent":["import { css } from \"styled-components\";\nconst blockquoteStyle = css `\n  blockquote {\n    border-left: 0.25em solid #d4d4d450;\n    margin-left: 0;\n    padding: 0 1em;\n  }\n`;\nconst codeStyle = css `\n  pre {\n    background-color: #d4d4d420;\n    border: 1px solid grey;\n    border-radius: 3px;\n    line-height: 1em;\n    overflow: visible;\n    padding: 0.5em;\n  }\n`;\nconst headingStyle = css `\n  h1,\n  h2,\n  h3,\n  h4,\n  h5,\n  h6 {\n  }\n`;\nconst linkStyle = css `\n  a {\n  }\n`;\nconst listStyle = css `\n  ul.contains-task-list {\n    list-style-type: none;\n    padding-left: 0;\n\n    .task-list-item-checkbox {\n      margin-left: 0.6em;\n      margin-right: 0.3em;\n      transform: scale(1.5);\n    }\n  }\n`;\nconst paragraphStyle = css `\n  p {\n  }\n`;\nconst tableStyle = css `\n  table {\n    border-collapse: collapse;\n    width: 80%;\n\n    tr:nth-child(even) {\n      background-color: ${(props) => props.theme.colorScheme.lightgrey}40;\n    }\n\n    th,\n    td {\n      padding: 0.3em;\n    }\n  }\n\n  table,\n  th,\n  td {\n    border: 1px solid ${(props) => props.theme.colorScheme.lightgrey};\n  }\n`;\nconst slideStyle = css `\n  section {\n    align-items: stretch;\n    background-color: white;\n    display: flex;\n    flex-direction: column;\n    flex-wrap: nowrap;\n    font-size: 25px;\n    height: 100%;\n    justify-content: center;\n    padding: 3em;\n    width: 100%;\n\n    * {\n      margin-top: 0;\n      &:last-child {\n        margin-bottom: 0 !important;\n      }\n    }\n\n    ${blockquoteStyle}\n    ${codeStyle}\n    ${headingStyle}\n    ${linkStyle}\n    ${listStyle}\n    ${paragraphStyle}\n    ${tableStyle}\n  }\n`;\nexport { slideStyle };\n","import React from \"react\";\nimport HtmlToReact, { Parser } from \"html-to-react\";\n\ninterface Node {\n  name: string;\n  attribs: Record<string, string>;\n}\n\nfunction render(htmlString: HtmlString): SlideContentElements {\n  const TABLE_TAGS = [\"table\", \"thead\", \"tbody\", \"tr\"];\n  function isTableDescendent(parent) {\n    return parent && TABLE_TAGS.includes(parent.name);\n  }\n  const isValidNode = () => true;\n\n  const processNodeDefinitions = new HtmlToReact.ProcessNodeDefinitions(React);\n  const processingInstructions = [\n    {\n      shouldProcessNode({ parent, type }) {\n        if (type === \"text\" && isTableDescendent(parent)) {\n          return false;\n        }\n        return true;\n      },\n      processNode: processNodeDefinitions.processDefaultNode,\n    },\n  ];\n  const parser = new Parser({\n    lowerCaseTags: false,\n    lowerCaseAttributeNames: false,\n  });\n  return parser.parseWithInstructions(\n    htmlString,\n    isValidNode,\n    processingInstructions\n  );\n}\n\nexport { render };\n","import React, { memo, useRef } from \"react\";\nimport styled from \"styled-components\";\n\nimport { slideStyle } from \"./slide-style\";\nimport { useElements } from \"./useElements\";\nimport { useSlideObserve } from \"./useSlideObserve\";\nimport { useCodeLineObserve } from \"./useCodeLineObserve\";\n\nconst SlideContainer = styled.div`\n  margin: 0.5em;\n  border: 1px solid ${(props) => props.theme.colorScheme.lightgrey};\n  box-shadow: 0px 1px 2px 1px ${(props) => props.theme.colorScheme.lightgrey}70;\n\n  ${slideStyle}\n`;\n\ninterface SlideProps {\n  htmlString: HtmlString;\n  index: number;\n}\n\nconst Slide = memo(function Slide({ htmlString, index }: SlideProps) {\n  const ref = useRef<HTMLDivElement>(null);\n\n  const elements = useElements(htmlString);\n  useSlideObserve({ ref, slideNumber: index + 1 });\n  useCodeLineObserve({ elements, ref });\n\n  return (\n    <SlideContainer ref={ref} className=\"slide\" id={`slide-${index + 1}`}>\n      {elements}\n    </SlideContainer>\n  );\n});\n\nexport { Slide };\n","import { useEffect, useState } from \"react\";\nimport { render } from \"utils/render\";\nfunction useElements(htmlString) {\n    const [elements, setElements] = useState(null);\n    useEffect(() => setElements(render(htmlString)), [htmlString]);\n    return elements;\n}\nexport { useElements };\n","import { useEffect } from \"react\";\nimport { useSlideObserver } from \"contexts/SlideObserver\";\nfunction useSlideObserve({ ref, slideNumber }) {\n    const { observe, unobserve } = useSlideObserver();\n    useEffect(() => {\n        if (ref.current)\n            observe(slideNumber, ref.current);\n        return () => unobserve(slideNumber);\n    }, [ref, slideNumber, observe, unobserve]);\n}\nexport { useSlideObserve };\n","import { useEffect } from \"react\";\nimport { useCodeLineObserver } from \"contexts/CodeLineObserver\";\nimport { CODE_LINE_CLASS_NAME, DATA_LINE_ATTRIBUTE, } from \"utils/parsePlugins/injectLineNumber\";\nfunction useCodeLineObserve({ elements, ref }) {\n    const { observe } = useCodeLineObserver();\n    useEffect(() => {\n        const node = ref.current;\n        if (node) {\n            const entries = {};\n            const codeLineElements = node === null || node === void 0 ? void 0 : node.querySelectorAll(`.${CODE_LINE_CLASS_NAME}`);\n            codeLineElements.forEach((element) => {\n                const dataLine = element.getAttribute(DATA_LINE_ATTRIBUTE);\n                if (dataLine)\n                    entries[dataLine] = element;\n            });\n            observe(entries);\n        }\n    }, [elements, ref, observe]);\n}\nexport { useCodeLineObserve };\n","/* eslint-disable */\nconst RULES = [\n    \"blockquote_open\",\n    \"code_block\",\n    \"fence\",\n    \"heading_open\",\n    \"image\",\n    \"link_open\",\n    \"list_item_open\",\n    \"paragraph_open\",\n    \"table_open\",\n];\nconst CODE_LINE_CLASS_NAME = \"code-line\";\nconst DATA_LINE_ATTRIBUTE = \"data-line\";\nfunction injectLineNumber(md) {\n    const { marpit_inline_svg_open } = md.renderer.rules;\n    // Enables line sync by per slides\n    md.renderer.rules.marpit_inline_svg_open = (tokens, idx, opts, env, self) => {\n        var _a;\n        const slide = tokens\n            .slice(idx + 1)\n            .find((t) => t.type === \"marpit_slide_open\");\n        if ((_a = slide.map) === null || _a === void 0 ? void 0 : _a.length) {\n            tokens[idx].attrJoin(\"className\", CODE_LINE_CLASS_NAME);\n            tokens[idx].attrSet(DATA_LINE_ATTRIBUTE, slide.map[0]);\n        }\n        const renderer = marpit_inline_svg_open || self.renderToken;\n        return renderer.call(self, tokens, idx, opts, env, self);\n    };\n    // Enables line sync per elements\n    RULES.forEach((rule) => {\n        const original = md.renderer.rules[rule];\n        md.renderer.rules[rule] = (tokens, idx, options, env, self) => {\n            var _a;\n            const token = tokens[idx];\n            if ((_a = token.map) === null || _a === void 0 ? void 0 : _a.length) {\n                token.attrJoin(\"className\", CODE_LINE_CLASS_NAME);\n                token.attrSet(DATA_LINE_ATTRIBUTE, token.map[0]);\n            }\n            const renderer = original || self.renderToken;\n            return renderer.call(self, tokens, idx, options, env, self);\n        };\n    });\n}\nexport { CODE_LINE_CLASS_NAME, DATA_LINE_ATTRIBUTE, injectLineNumber };\n"],"sourceRoot":""}