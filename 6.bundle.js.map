{"version":3,"sources":["webpack:///./src/components/TextEditor/index.tsx","webpack:///./src/components/TextEditor/useSyncTextArea.ts","webpack:///./src/components/TextEditor/useTrackTextAreaScroll.ts","webpack:///./src/utils/usePaneIsActive.ts"],"names":["TEXT_AREA_LINE_HEIGHT","Container","styled","div","TextArea","textarea","TextEditor","memo","ref","useRef","dispatch","useMarkdownDispatch","useMarkdownState","md","slideshowLineNumber","isActive","usePaneIsActive","initialValue","textAreaLineHeight","useEffect","getNode","R","calculateScrollTop","setScrollTop","scrollTop","n","useSyncTextArea","handleScroll","useMemo","throttle","e","getScrollTop","calculateLineNumber","textLineNumber","Math","floor","type","MarkdownContextReducerActionType","SetTextLineNumber","node","current","addEventListener","passive","removeEventListener","useTrackTextAreaScroll","autoFocus","onChange","SetMd","target","value","onKeyDown","keyCode","val","start","selectionStart","end","selectionEnd","substring","preventDefault","useState","setIsActive","debounceSetIsActive","debounce","handleMouseEnter","handleMouseLeave"],"mappings":"g6BAaA,IAAMA,EAAwB,GAExBC,EAAYC,IAAOC,IAAV,KAMTC,EAAWF,IAAOG,SAAV,IAKGL,GAaXM,EAAaC,gBAAK,WACtB,IAAMC,EAAMC,iBAA4B,MAClCC,EAAWC,cAF2B,EAGRC,cAA5BC,EAHoC,EAGpCA,GAAIC,EAHgC,EAGhCA,oBAENC,EAAWC,YAAgB,CAAER,MAAKS,cAAc,KC1CxD,YAA4E,IAAjDT,EAAiD,EAAjDA,IAAKM,EAA4C,EAA5CA,oBAAqBI,EAAuB,EAAvBA,mBAEjDC,qBAAU,WACN,IAAMC,EAAUC,IAAO,WACjBC,EAAqBD,IAAWH,EAAoBJ,GAEpDS,EAAeF,KAAQ,SAACG,EAAWC,GACrCA,EAAED,UAAYA,KAElBH,IAAOD,EAASC,IAASA,IAASE,EAAaD,IAA/CD,CAAqEb,KACtE,CAACA,EAAKM,EAAqBI,IDkChCQ,CAAgB,CACdlB,MACAM,sBACAI,mBAAoBlB,IE7CxB,YAAkF,IAAhDU,EAAgD,EAAhDA,SAAUK,EAAsC,EAAtCA,SAAUP,EAA4B,EAA5BA,IAAKU,EAAuB,EAAvBA,mBACjDS,EAAeC,mBAAQ,kBAAMC,KAAS,SAACC,GACzC,IAAMC,EAAeV,IAAO,CAAC,SAAU,cACjCW,EAAsBX,IAASA,IAAMH,GACrCe,EAAiBZ,IAAOU,EAAcC,EAAqBE,KAAKC,MAA/Cd,CAAsDS,GAC7EpB,EAAS,CACL0B,KAAMC,IAAiCC,kBACvCL,qBAEL,OAAM,CAACvB,EAAUQ,IAEpBC,qBAAU,WACN,IAAMoB,EAAO/B,EAAIgC,QAGjB,OAFAzB,EACMwB,SAA4CA,EAAKE,iBAAiB,SAAUd,EAAc,CAAEe,SAAS,IAAUH,SAA4CA,EAAKI,oBAAoB,SAAUhB,GAC7L,kBAAMY,aAAmC,EAASA,EAAKI,oBAAoB,SAAUhB,MAC7F,CAACZ,EAAUY,EAAcnB,IF+B9BoC,CAAuB,CACrBlC,WACAK,WACAP,MACAU,mBAAoBlB,IAwBtB,OACE,kBAACC,EAAD,KACE,kBAACG,EAAD,CACEI,IAAKA,EACLqC,WAAS,EACTC,SA1BoB,SAAChB,GACzBpB,EAAS,CACP0B,KAAMC,IAAiCU,MACvClC,GAAIiB,EAAEkB,OAAOC,SAwBXC,UArBgB,SAACpB,GAErB,GAAkB,IAAdA,EAAEqB,QAAe,KACXH,EAAWlB,EAAXkB,OACFI,EAAMJ,EAAOC,MACbI,EAAQL,EAAOM,eACfC,EAAMP,EAAOQ,aAEnBR,EAAOC,MAAP,UAAkBG,EAAIK,UAAU,EAAGJ,GAAnC,aAA8CD,EAAIK,UAAUF,IAC5DP,EAAOM,eAAiBN,EAAOQ,aAAeH,EAAQ,EAEtDvB,EAAE4B,mBAWAT,MAAOpC,S,+GGpFf,SAASG,EAAT,GAAgD,IAArBR,EAAqB,EAArBA,IAAKS,EAAgB,EAAhBA,aACtBsB,EAAO/B,EAAIgC,QAD2B,EAEZmB,mBAAS1C,GAFG,WAErCF,EAFqC,KAE3B6C,EAF2B,KAc5C,OAXAzC,qBAAU,WACN,IAAM0C,EAAsBC,KAAS,SAACb,GAAD,OAAWW,EAAYX,KAAQ,KAC9Dc,EAAmB,kBAAMF,GAAoB,IAC7CG,EAAmB,kBAAMH,GAAoB,IAGnD,OAFAtB,SAA4CA,EAAKE,iBAAiB,aAAcsB,GAChFxB,SAA4CA,EAAKE,iBAAiB,aAAcuB,GACzE,WACHzB,SAA4CA,EAAKI,oBAAoB,aAAcoB,GACnFxB,SAA4CA,EAAKI,oBAAoB,aAAcqB,MAExF,CAACzB,EAAMqB,IACH7C","file":"6.bundle.js","sourcesContent":["import React, { memo, useRef } from \"react\";\nimport styled from \"styled-components\";\n\nimport {\n  useMarkdownDispatch,\n  useMarkdownState,\n} from \"contexts/MarkdownContext\";\nimport { MarkdownContextReducerActionType } from \"types/markdown-context-reducer-action\";\n\nimport { usePaneIsActive } from \"utils/usePaneIsActive\";\nimport { useSyncTextArea } from \"./useSyncTextArea\";\nimport { useTrackTextAreaScroll } from \"./useTrackTextAreaScroll\";\n\nconst TEXT_AREA_LINE_HEIGHT = 18;\n\nconst Container = styled.div`\n  background-color: #fafafa;\n  display: flex;\n  flex: 1;\n  flex-direction: column;\n`;\nconst TextArea = styled.textarea`\n  background-color: transparent;\n  border: none;\n  font-size: 15px;\n  height: 100%;\n  line-height: ${TEXT_AREA_LINE_HEIGHT}px;\n  outline: none;\n  padding: 1em;\n  resize: none;\n  tab-size: 2;\n  /* Chrome, Safari and Opera */\n  ::-webkit-scrollbar {\n    display: none;\n  }\n  -ms-overflow-style: none; /* IE and Edge */\n  scrollbar-width: none; /* Firefox */\n`;\n\nconst TextEditor = memo(function TextEditor() {\n  const ref = useRef<HTMLTextAreaElement>(null);\n  const dispatch = useMarkdownDispatch();\n  const { md, slideshowLineNumber } = useMarkdownState();\n\n  const isActive = usePaneIsActive({ ref, initialValue: true });\n\n  useSyncTextArea({\n    ref,\n    slideshowLineNumber,\n    textAreaLineHeight: TEXT_AREA_LINE_HEIGHT,\n  });\n  useTrackTextAreaScroll({\n    dispatch,\n    isActive,\n    ref,\n    textAreaLineHeight: TEXT_AREA_LINE_HEIGHT,\n  });\n\n  const handleInputChange = (e) => {\n    dispatch({\n      type: MarkdownContextReducerActionType.SetMd,\n      md: e.target.value,\n    });\n  };\n  const handleKeyDown = (e) => {\n    // support tabs\n    if (e.keyCode === 9) {\n      const { target } = e;\n      const val = target.value;\n      const start = target.selectionStart;\n      const end = target.selectionEnd;\n\n      target.value = `${val.substring(0, start)}\\t${val.substring(end)}`;\n      target.selectionStart = target.selectionEnd = start + 1; // eslint-disable-line no-multi-assign\n\n      e.preventDefault();\n    }\n  };\n\n  return (\n    <Container>\n      <TextArea\n        ref={ref}\n        autoFocus\n        onChange={handleInputChange}\n        onKeyDown={handleKeyDown}\n        value={md}\n      />\n    </Container>\n  );\n});\n\nexport { TEXT_AREA_LINE_HEIGHT, TextEditor };\n","import { useEffect } from \"react\";\nimport * as R from \"ramda\";\nfunction useSyncTextArea({ ref, slideshowLineNumber, textAreaLineHeight, }) {\n    /* Syncs text when slideshowLineNumber changes */\n    useEffect(() => {\n        const getNode = R.prop(\"current\");\n        const calculateScrollTop = R.multiply(textAreaLineHeight, slideshowLineNumber);\n        // TODO smooth scrolling\n        const setScrollTop = R.curry((scrollTop, n) => {\n            n.scrollTop = scrollTop; // eslint-disable-line no-param-reassign\n        });\n        R.pipe(getNode, R.unless(R.isNil, setScrollTop(calculateScrollTop)))(ref);\n    }, [ref, slideshowLineNumber, textAreaLineHeight]);\n}\nexport { useSyncTextArea };\n","import { useEffect, useMemo } from \"react\";\nimport * as R from \"ramda\";\nimport throttle from \"lodash/throttle\";\nimport { MarkdownContextReducerActionType, } from \"types/markdown-context-reducer-action\";\nfunction useTrackTextAreaScroll({ dispatch, isActive, ref, textAreaLineHeight, }) {\n    const handleScroll = useMemo(() => throttle((e) => {\n        const getScrollTop = R.path([\"target\", \"scrollTop\"]);\n        const calculateLineNumber = R.divide(R.__, textAreaLineHeight);\n        const textLineNumber = R.pipe(getScrollTop, calculateLineNumber, Math.floor)(e);\n        dispatch({\n            type: MarkdownContextReducerActionType.SetTextLineNumber,\n            textLineNumber,\n        });\n    }, 200), [dispatch, textAreaLineHeight]);\n    /* Adds/Removes event listener on 'scroll' depending on pane `isActive` */\n    useEffect(() => {\n        const node = ref.current;\n        isActive\n            ? node === null || node === void 0 ? void 0 : node.addEventListener(\"scroll\", handleScroll, { passive: true }) : node === null || node === void 0 ? void 0 : node.removeEventListener(\"scroll\", handleScroll);\n        return () => node === null || node === void 0 ? void 0 : node.removeEventListener(\"scroll\", handleScroll);\n    }, [isActive, handleScroll, ref]);\n}\nexport { useTrackTextAreaScroll };\n","import { useEffect, useState } from \"react\";\nimport debounce from \"lodash/debounce\";\nfunction usePaneIsActive({ ref, initialValue }) {\n    const node = ref.current;\n    const [isActive, setIsActive] = useState(initialValue);\n    useEffect(() => {\n        const debounceSetIsActive = debounce((value) => setIsActive(value), 300);\n        const handleMouseEnter = () => debounceSetIsActive(true);\n        const handleMouseLeave = () => debounceSetIsActive(false);\n        node === null || node === void 0 ? void 0 : node.addEventListener(\"mouseenter\", handleMouseEnter);\n        node === null || node === void 0 ? void 0 : node.addEventListener(\"mouseleave\", handleMouseLeave);\n        return () => {\n            node === null || node === void 0 ? void 0 : node.removeEventListener(\"mouseenter\", handleMouseEnter);\n            node === null || node === void 0 ? void 0 : node.removeEventListener(\"mouseleave\", handleMouseLeave);\n        };\n    }, [node, setIsActive]);\n    return isActive;\n}\nexport { usePaneIsActive };\n"],"sourceRoot":""}